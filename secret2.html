<!DOCTYPE html>
<html>
<body>
    <h2>Documento Cifrato</h2>
    <p id="documentoCifrato"></p>

    <h3>Inserisci il codice per decifrare (alfabetoribaltato):</h3>
    <input type="text" id="codiceDecodifica">
    <button onclick="decifraMessaggio()">Decifra</button>
    
    <h3>Documento Decifrato</h3>
    <p id="documentoDecifrato"></p>

    <button onclick="tornaACifratura()">Torna alla pagina di cifratura</button>

    <script>
        function cifraStringa(testo) {
            const alfabetoNormale = "abcdefghijklmnopqrstuvwxyz";
            const alfabetoCapovolto = "zyxwvutsrqponmlkjihgfedcba";
            let risultato = "";
            for (let i = 0; i < testo.length; i++) {
                let lettera = testo[i].toLowerCase();
                let pos = alfabetoNormale.indexOf(lettera);
                risultato += pos !== -1 ? alfabetoCapovolto[pos] : lettera;
            }
            return risultato;
        }

        function decifraMessaggio() {
            let codice = document.getElementById("codiceDecodifica").value.toLowerCase();
            let documentoCifrato = localStorage.getItem("contenutoCifrato");
            if (!documentoCifrato) {
                alert("Nessun documento cifrato trovato.");
                return;
            }
            if (codice !== "jacopo") {
                alert("Codice errato! Riprova.");
                return;
            }
            document.getElementById("documentoDecifrato").innerText = cifraStringa(documentoCifrato);
        }

        function tornaACifratura() {
            window.location.href = "secret1.html";
        }

        window.onload = function() {
            let documentoCifrato = localStorage.getItem("contenutoCifrato");
            if (documentoCifrato) {
                document.getElementById("documentoCifrato").innerText = documentoCifrato;
            }
        };
    </script>
</body>
</html>
